<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yoga for Everyone</title>
    <link rel="stylesheet" href="yoga.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
</head>
<body>
    <header>
        <p>Your Yoga Space</p>
        <hr>
        <nav>
            <ul style="display: flex">
                <div class="dropdown">
                    <div class="menu-button" onclick="toggleMenu()"><img src="profile.avif"></div>
                    <div id="menu" class="menu">
                        <ul class="profile" id="userProfile">
                            <li>Loading...</li>
                        </ul>
                    </div>
                </div>
                <div style="margin-left: auto;display: flex;"> 
                    <li><a href="yoga.html">HOME</a></li>
                    <li><a href="courses.html">COURSES</a></li>
                    <li><a href="yogabodyproblem.html">YOGA FOR BODY PAIN</a></li>
                    <li><a href="yogaasana.html">YOGA ASANAS</a></li>
                    <li><a href="blog.html">BLOG</a></li>
                    <li><a href="yogacontactus.html">CONTACT US</a></li>
                </div>
            </ul>
        </nav>
    </header>
    
    <main>
        <section id="intro">
            <h2>Discover the Benefits of Yoga</h2>
            <p style="color: whitesmoke;">Join us on a journey to improve your physical and mental well-being through yoga.</p>
        </section>
        
        <section id="featured">
            <h2>Featured Courses</h2>
            <p style="color: whitesmoke;">Explore our range of yoga courses designed for all levels.</p>
            <a href="courses.html">View Courses</a>
        </section>
    </main>
    
    <footer>
        <p>&copy; 2025 Yoga for Everyone | All Rights Reserved</p>
    </footer>
    
    <!-- Firebase scripts -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.10.0/firebase-app.js";
        import { 
            getAuth, 
            onAuthStateChanged, 
            signOut 
        } from "https://www.gstatic.com/firebasejs/10.10.0/firebase-auth.js";
        import { 
            getFirestore, 
            doc, 
            getDoc 
        } from "https://www.gstatic.com/firebasejs/10.10.0/firebase-firestore.js";
        
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBfIElG6SXE_JXaJrgmGNgkt1Ta5jjbO4w",
            authDomain: "yogadt-ed173.firebaseapp.com",
            projectId: "yogadt-ed173",
            storageBucket: "yogadt-ed173.firebasestorage.app",
            messagingSenderId: "877729470017",
            appId: "1:877729470017:web:d6d4f90eb0b553d09a58c0"
        };
        
        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        
        // Check if a user is logged in and fetch their name from Firestore
        onAuthStateChanged(auth, async (user) => {
            if (user) {
                console.log("User is logged in:", user.email);
        
                // Fetch user data from Firestore
                const userDoc = await getDoc(doc(db, "users", user.uid));
                let fullName = "User"; // Default name in case Firestore doesn't return anything
        
                if (userDoc.exists()) {
                    fullName = userDoc.data().fullName || "User";
                } else {
                    console.warn("No user document found in Firestore.");
                }
        
                // Update the profile dropdown dynamically
                const userProfile = document.getElementById("userProfile");
                userProfile.innerHTML = `
                    <li><strong>${fullName}</strong></li>
                    <li>${user.email}</li>
                    <button id="logoutBtn">Logout</button>
                `;
        
                // Logout functionality
                document.getElementById("logoutBtn").addEventListener("click", async () => {
                    try {
                        await signOut(auth);
                        alert("Logged out successfully.");
                        window.location.href = "login.html"; // Redirect to login page after logout
                    } catch (error) {
                        console.error("Logout Error:", error);
                    }
                });
            else {
                    console.log("No user found. Redirecting...");
                    window.location.href = "login.html";
                }
            } 
        });

</script>

<script>
    function toggleMenu() {
        var menu = document.getElementById("menu");
        menu.style.display = (menu.style.display === "block") ? "none" : "block";
    }
    
    document.addEventListener("click", function(event) {
        var menu = document.getElementById("menu");
        var button = document.querySelector(".menu-button");
        
        if (!menu.contains(event.target) && !button.contains(event.target)) {
            menu.style.display = "none";
        }
    });
    </script>
</body>
</html>
